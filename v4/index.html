<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Excel Daten extrahieren und in Variablen speichern</title>
    <!-- Einbinden der Office JavaScript-Bibliothek -->
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
    <h1>Excel Daten extrahieren und in Variablen speichern</h1>
    <div id="myExcelDiv" style="width: 500px; height: 300px"></div>
    <pre id="output"></pre> <!-- Container fÃ¼r die ausgegebenen Daten -->
    
    <!-- Einbettung der Excel-Datei -->
    <script type="text/javascript" src="https://onedrive.live.com/embed?resid=6B667B1F38771467%219796&authkey=%21ACDi9dVQfBjJ4jc&em=3&wdItem=%22'Sheet1'!O2%3AS4%22&wdDivId=%22myExcelDiv%22&wdDownloadButton=1&wdHideGridlines=1&wdAllowInteractivity=0"></script>
    
    <h2>Variablenwerte aus Excel-Tabelle:</h2>
    <div id="variableValues">
        <h3 id="cell_O2"></h3>
        <h3 id="cell_P2"></h3>
        <h3 id="cell_Q2"></h3>
        <h3 id="cell_R2"></h3>
        <h3 id="cell_S2"></h3>
        <h3 id="cell_O3"></h3>
        <h3 id="cell_P3"></h3>
        <h3 id="cell_Q3"></h3>
        <h3 id="cell_R3"></h3>
        <h3 id="cell_S3"></h3>
        <h3 id="cell_O4"></h3>
        <h3 id="cell_P4"></h3>
        <h3 id="cell_Q4"></h3>
        <h3 id="cell_R4"></h3>
        <h3 id="cell_S4"></h3>
    </div>

    <script>
        var c1 = document.getElementById("cell_O2");
        var c2 = document.getElementById("cell_P2");
        var c3 = document.getElementById("cell_Q2");
        var c4 = document.getElementById("cell_R2");
        var c5 = document.getElementById("cell_S2");
        var c6 = document.getElementById("cell_O3");
        var c7 = document.getElementById("cell_P3");
        var c8 = document.getElementById("cell_Q3");
        var c9 = document.getElementById("cell_R3");
        var c10 = document.getElementById("cell_S3");
        var c11 = document.getElementById("cell_O4");
        var c12 = document.getElementById("cell_P4");
        var c13 = document.getElementById("cell_Q4");
        var c14 = document.getElementById("cell_R4");
        var c15 = document.getElementById("cell_S4");

        Office.onReady(function(info) {
            if (info.host === Office.HostType.Excel) {
                function getData() {
                    return Excel.run(function(context) {
                        var sheet = context.workbook.worksheets.getItem("Sheet1");
                        var range = sheet.getRange("O2:S4");
                        range.load("values");

                        return context.sync().then(function() {
                            var data = range.values;
                            c1.textContent = "O2: " + data[0][0];
                            c2.textContent = "P2: " + data[0][1];
                            c3.textContent = "Q2: " + data[0][2];
                            c4.textContent = "R2: " + data[0][3];
                            c5.textContent = "S2: " + data[0][4];
                            c6.textContent = "O3: " + data[1][0];
                            c7.textContent = "P3: " + data[1][1];
                            c8.textContent = "Q3: " + data[1][2];
                            c9.textContent = "R3: " + data[1][3];
                            c10.textContent = "S3: " + data[1][4];
                            c11.textContent = "O4: " + data[2][0];
                            c12.textContent = "P4: " + data[2][1];
                            c13.textContent = "Q4: " + data[2][2];
                            c14.textContent = "R4: " + data[2][3];
                            c15.textContent = "S4: " + data[2][4];
                        });
                    }).catch(function(error) {
                        console.log("Error: " + error);
                    });
                }

                getData();
            }
        });
    </script>
</body>
</html>
